# งานกลุ่มวิชาระบบปฏิบัติการ ชั้นปีที่ 3 เทอมต้น ปีการศึกษา 2562
---
## โจทย์ปัญหา
---
จากไฟล์เอกสารงานที่ได้รับมอบหมายมา [PDF File](https://github.com/ipskm/ProOS/blob/master/KU%20Assignment%201.pdf) มีรายละเอียดดังนี้
1. <strong>ปัญหา</strong>
สมมติว่านศ.มีบัฟเฟอร์แบบวนกลับ (circular buffer) ใช้สำหรับการทำงานแบบคิวหรือ First-in-first-out โดยมีฃนาดที่เก็บ ข้อมูลได้ N รายการ (1 <= N <= 1000) ที่ถูกใช้งานร่วมกันด้วยเทรด(thread) มากกว่า 1 เทรด<br>
<ul><b>1.1)Basic Operations:</b> ให้เขียนฟ้งก์ชัน 2 ฟ้งก์ชันต่อไปนี้ เพื่อรองรับการทำงานแบบ circular buffer โดยสมมติว่า ณ เวลาใดเวลาหนึ่งจะมีเทรด (thread) ที่เรืยกฟ้งก์ชันนี้ได้เพียงเทรดเดียวเท่านั้น<ul>
<li>add_item - เพิ่มรายการเช้าไปในท้ายแถวของบัฟเฟอร์</li>
<li>remove_item - ลบรายการหัวแถวออกจากบัฟเฟอร์</li>
</ul></ul>
<ul><b>1.2)Concurrent Operations:</b> ให้นักศึกษาเขียนพีงก์ชัน append และ remove ซึ่งเรียกใช้พีงก์ชันในข้อ 1.1 แต่รองรับ การทำงานแบบหลายเทรดพร้อม ๆ กัน โดยจะมีคุณสมบัติดังต่อไปนี้<ul>
<li> 1.1.1	Mutually exclusive access to buffer: ณ เวลาใดเวลาหนึ่ง จะมีเพียงเทรดหนึ่งเทรดเท่านั้นที่สามารถเพิ่ม หรือลบรายการในบัฟเฟอร์ได้</li>
<li>1.1.2	No buffer overflow: เทรดสำหรับ append จะสามารถเรียกใช้ addjtem ได้ก็ต่อเมื่อบัฟเฟอร์ไม่เต็ม (ให้ รอจนกว่าบัฟเฟอร์จะมีพื้นที่เหลือก่อนที่จะเรียก addjtem)</li>
<li>1.1.3	No buffer underflow: เทรดสำหรับ remove จะสามารถเรียกใช้ removejtem ได้ก็ต่อเมื่อบัฟเฟอร์ไม่ว่าง (ถ้าว่างให้รอจนกว่าจะมีรายการในบัฟเฟอร์ก่อนเรียก removejtem)</li>
<li>1.1.4	No busy waiting: ห้ามใช้สปีนล็อก(spinlock) ในการรอตรวจสอบเงื่อนไขของบัฟเฟอร์</li>
<li>1.1.5	No producer starvation: เทรดที่จะเรียก append มีเวลารอคอยที่จำกัด</li>
<li>1.1.6	No consumer starvation: เทรดที่จะเรียก remove มีเวลารอคอยที่จำกัด</li></ul></ul>
<ul>
<b>1.2	Buffer Benchmark:</b> ให้นักศึกษาเขียนโปรแกรม buff ที่ทำงานได้หลายเทรดพร้อม ๆ กัน เพื่อทดสอบประสิทธิภาพ ของ append และ remove โดยให้เทรดของการผลิตทั้งหมดสร้างรายการตามจำนวนที่ระบุใส่ในบัฟเฟอร์ ในขณะที่ เทรดของการเรียกใช้ดึงรายการออกจากบัฟเฟอร์ และให้โปรแกรม buff นับจำนวนรายการที่ถูกดึงออกมาและเวลาที่ใช้ ในการทำงาน โดย buff จะรับพารามิเตอร์ต่อไปนี้<ul>
<li> 1.2.1	จำนวนเทรดของการผลิต (producer thread - เทรดที่เรียก append)</li>
<li> 1.2.2	จำนวนเทรดของการเรียกใช้ (consumer thread - เทรดที่เรียก remove)</li>
<li> 1.2.3	ขนาดของบัฟเฟอร์ (N)</li>
<li> 1.2.4	จำนวนรายการที่จะผลิตทั้งหมด (ไม่เกิน 1,000 ล้าน requests)</li> </ul></ul>
<b><u>ตัวอย่าง</u></b> ทดสอบโปรแกรมโดยให้มีเทรดผลิต 20 เทรด, มีเทรดเรียกใช้ 30 เทรด, บัฟเฟอร์ขนาด 1000 รายการ และ ผลิตรายการทั้งหมด 100000 รายการ<br> # buff 20 30 1000 100000<br>
Producers 20,<br> Consumers 30<br> Buffer size 1000 <br>Requests 100000<br>
Successfully consumed 95401 requests (95.4%)<br>
Elapsed Time: 31.40 s<br>
Throughput: 3038.25 successful requests/s<br>
โดยงานนี้มีจุดประสงค์หลักให้อัตรา Throughput มีค่าสูงสุด <Br>
Assignment นี้จะเป็นงานกลุ่มโดยกลุ่มหนึ่งจะมีจำนวน 11-12 คน (4 กลุ่ม)<bR><br>
<hr>
