# งานกลุ่มวิชาระบบปฏิบัติการ ชั้นปีที่ 3 เทอมต้น ปีการศึกษา 2562
---
## โจทย์ปัญหา
---
จากไฟล์เอกสารงานที่ได้รับมอบหมายมา [PDF File](https://github.com/ipskm/ProOS/blob/master/KU%20Assignment%201.pdf) มีรายละเอียดดังนี้
1. ปัญหา
สมมติว่านศ.มีบัฟเฟอร์แบบวนกลับ (circular buffer) ใช้สำหรับการทำงานแบบคิวหรือ First-in-first-out โดยมีฃนาดที่เก็บ ข้อมูลได้ N รายการ (1 <= N <= 1000) ที่ถูกใช้งานร่วมกันด้วยเทรด(thread) มากกว่า 1 เทรด
1.1	)Basic Operations: ให้เขียนฟ้งก์ชัน 2 ฟ้งก์ชันต่อไปนี้ เพื่อรองรับการทำงานแบบ circular buffer โดยสมมติว่า ณ เวลาใดเวลาหนึ่งจะมีเทรด (thread) ที่เรืยกฟ้งก์ชันนี้ได้เพียงเทรดเดียวเท่านั้น
addjtem - เพิ่มรายการเช้าไปในท้ายแถวของบัฟเฟอร์ removejtem - ลบรายการหัวแถวออกจากบัฟเฟอร์
1.2	Concurrent Operations: ให้นักศึกษาเขียนพีงก์ชัน append และ remove ซึ่งเรียกใช้พีงก์ชันในข้อ 1.1 แต่รองรับ การทำงานแบบหลายเทรดพร้อม ๆ กัน โดยจะมีคุณสมบัติดังต่อไปนี้
1.1.1	Mutually exclusive access to buffer: ณ เวลาใดเวลาหนึ่ง จะมีเพียงเทรดหนึ่งเทรดเท่านั้นที่สามารถเพิ่ม หรือลบรายการในบัฟเฟอร์ได้
1.1.2	No buffer overflow: เทรดสำหรับ append จะสามารถเรียกใช้ addjtem ได้ก็ต่อเมื่อบัฟเฟอร์ไม่เต็ม (ให้ รอจนกว่าบัฟเฟอร์จะมีพื้นที่เหลือก่อนที่จะเรียก addjtem)
1.1.3	No buffer underflow: เทรดสำหรับ remove จะสามารถเรียกใช้ removejtem ได้ก็ต่อเมื่อบัฟเฟอร์ไม่ว่าง (ถ้าว่างให้รอจนกว่าจะมีรายการในบัฟเฟอร์ก่อนเรียก removejtem)
1.1.4	No busy waiting: ห้ามใช้สปีนล็อก(spinlock) ในการรอตรวจสอบเงื่อนไขของบัฟเฟอร์
1.1.5	No producer starvation: เทรดที่จะเรียก append มีเวลารอคอยที่จำกัด
1.1.6	No consumer starvation: เทรดที่จะเรียก remove มีเวลารอคอยที่จำกัด
1.2	Buffer Benchmark: ให้นักศึกษาเขียนโปรแกรม buff ที่ทำงานได้หลายเทรดพร้อม ๆ กัน เพื่อทดสอบประสิทธิภาพ ของ append และ remove โดยให้เทรดของการผลิตทั้งหมดสร้างรายการตามจำนวนที่ระบุใส่ในบัฟเฟอร์ ในขณะที่ เทรดของการเรียกใช้ดึงรายการออกจากบัฟเฟอร์ และให้โปรแกรม buff นับจำนวนรายการที่ถูกดึงออกมาและเวลาที่ใช้ ในการทำงาน โดย buff จะรับพารามิเตอร์ต่อไปนี้
1.2.1	จำนวนเทรดของการผลิต (producer thread - เทรดที่เรียก append)
1.2.2	จำนวนเทรดของการเรียกใช้ (consumer thread - เทรดที่เรียก remove)
1.2.3	ขนาดของบัฟเฟอร์ (N)
1.2.4	จำนวนรายการที่จะผลิตทั้งหมด (ไม่เกิน 1,000 ล้าน requests)
ตัวอย่าง ทดสอบโปรแกรมโดยให้มีเทรดผลิต 20 เทรด, มีเทรดเรียกใช้ 30 เทรด, บัฟเฟอร์ขนาด 1000 รายการ และ ผลิตรายการทั้งหมด 100000 รายการ # buff 20 30 1000 100000
Producers 20, Consumers 30 Buffer size 1000 Requests 100000
Successfully consumed 95401 requests (95.4%)
Elapsed Time: 31.40 ร
Throughput: 3038.25 successful requests/s
โดยงานนี้มีจุดประสงค์หลักให้อัตรา Throughput มีค่าสูงสุด Assignment นี้จะเป็นงานกลุ่มโดยกลุ่มหนึ่งจะมีจำนวน 11-12 คน (4 กลุ่ม)
2.	สิ่งที่ต้องส่ง
a.	Design Document: รายงานการออกแบบ
i.	การออกแบบ เงื่อนไข วิธีการทำงาน และการพิสูจน์คุณสมบัติของ append
ii.	การออกแบบ เงื่อนไข และวิธีการทำงานของ remove
b.	Program Source: URL เพื่อเข้าถึง Source code repository (e.g. GitHub) ของโปรแกรม
c.	Presentation: การนำเสนอ/สาธิตการทำงานของโปรแกรม และการตอบคำถาม
3.	เกณฑ์การให้คะแนน
a.	10 คะแนน รายงานที่มีผลการวิเคราะห์การออกแบบ และคำอธิบายแสดงถึงความถูกต้องของโปรแกรม
b.	50 คะแนน - การพัฒนาโปรแกรม (Implementation): Completion, Performance, Reliability
i.	Completion พิจารณาจากโปรแกรมทำงานตามที่กำหนดและมีผลลัพธ์ตามที่กำหนดในงาน
ii.	Performance จะคิดจากจำนวน Successful requests/ ร เรียงตามลำดับแต่ละกลุ่มในขั้นเรียน โดยคิดฐานการคำนวณจาก 1000 ล้าน requests บน CPU ที่มี 4 logical cores
iii.	Reliability คิดจากอัตราส่วนจำนวน success requests ต่อจำนวน requests ทั้งหมด
C. 40 คะแนน - Presentation, Q&A (มีสิทธิถามใครก็ได้ในกลุ่มในการตอบคำถามหรือนำเสนอผลงาน)
4.	อื่น ๆ
a.	Late submission - นักศึกษาไม่สามารถส่งงานข้าเกินกว่าที่กำหนดในใบงานได้ หากส่งข้าเกินกำหนดจะได้ คะแนนเป็นศูนย์สำหรับงานนี้
b.	Academic Integrity & Plagiarism - สามารถพูดคุยแลกเปลี่ยนแนวทางต่างๆ ทีเหมาะสมกับการ แก้ป้ญหาได้ แต่ไม1สามารถแชร์โปรแกรมหรือดัดลอก source code จากเพื่อนหรือแหล่งข้อมูลภายนอกได้ หากมีเหตุการณ์หรือสถานการณ์ที่บ่งขี้ว่ากลุ่มใดไม่ได้พยายามทำงานด้วยตนเองจะได้คะแนนศูนย์ในงานนี้
